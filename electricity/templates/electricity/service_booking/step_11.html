{% extends "electricity/service_booking/base.html" %}
{% load i18n %}
{% block booking_content %}
<form method="post" class="booking-form">
  {% csrf_token %}

  <div class="final-review">
    <div>

      <!-- Service Details -->
      <div class="final-card">
        <div class="final-card-header">
          <span class="section-index">13</span>
          <span>{% trans "Service Details" %}</span>
          <a class="final-edit" href="{% url 'electricity:service_booking_step' 4 %}">
            {% trans "Edit" %}
          </a>
        </div>

        <div class="review-row">
          <span>{% trans "Service Type" %}</span>
          <span>{% trans "Licensed Master Electrician" %}</span>
        </div>

        <div class="review-row">
          <span>{% trans "Tasks" %}</span>
          <span>
            {% if pricing_type == "hourly" %}
              {% trans "Hourly electrician booking" %}
            {% else %}
              {{ data.service_names|default:"Install 3 Light Fixtures, Upgrade Main Circuit Panel, Replace 2 GFCI Outlets" }}
            {% endif %}
          </span>
        </div>

        <div class="review-row">
          <span>{% trans "Priority" %}</span>
          <span>
            {% if data.urgent %}
              {% trans "Urgent" %}
            {% else %}
              {% trans "Standard (Next Available)" %}
            {% endif %}
          </span>
        </div>
      </div>

      <!-- Arrival Info -->
      <div class="final-card">
        <div class="final-card-header">
          <span class="section-index">14</span>
          <span>{% trans "Arrival Information" %}</span>
          <a class="final-edit" href="{% url 'electricity:service_booking_step' 6 %}">
            {% trans "Edit" %}
          </a>
        </div>

        <div class="review-row">
          <span>{% trans "Date & Time" %}</span>
          <span>
            {{ data.preferred_date|default:"Thursday, Oct 24th, 2024" }} –
            {{ data.preferred_time_slot|default:"09:00 AM - 11:00 AM" }}
          </span>
        </div>

        <div class="review-row">
          <span>{% trans "Service Address" %}</span>
          <span>
            {{ data.street_address|default:"4522 Evergreen Terrace" }},
            {{ data.city|default:"San Francisco" }}
          </span>
        </div>

        <div class="review-row">
          <span>{% trans "Contact Person" %}</span>
          <span>{{ data.full_name|default:"Alex Thompson" }}</span>
        </div>
      </div>

      <!-- Legal Note -->
      <div class="final-note">
        {% blocktrans %}
        By clicking "BOOK ELECTRICIAN", you agree to our Terms of Service and Privacy Policy.
        {% endblocktrans %}

        {% if pricing_type == "hourly" %}
          {% blocktrans with hours=hourly_hours rate=hourly_rate_electrician currency=currency %}
          The price below is calculated based on {{ hours }} hour(s) at {{ rate }} {{ currency }}/hr.
          {% endblocktrans %}
        {% else %}
          {% trans "The price below reflects the fixed services you selected." %}
        {% endif %}
      </div>

    </div>

    <!-- Cost Summary -->
    <div class="final-cost">

      <div class="cost-title">{% trans "Estimated Cost" %}</div>
      <div class="cost-amount">{{ cost_total }} {{ currency }}</div>

      {% if pricing_type == "hourly" %}
        <div class="cost-sub">{% trans "Hourly booking" %}</div>
        <div class="cost-row">
          <span>{% trans "Hourly Rate" %}</span>
          <span>{{ hourly_rate_electrician }} {{ currency }}</span>
        </div>
        <div class="cost-row">
          <span>{% trans "Estimated Hours" %}</span>
          <span>{{ hourly_hours }} {% trans "hr" %}</span>
        </div>
      {% else %}
        <div class="cost-sub">{% trans "Fixed service price" %}</div>
        <div class="cost-row">
          <span>{% trans "Fixed Services Total" %}</span>
          <span>{{ fixed_services_total }} {{ currency }}</span>
        </div>
      {% endif %}

      <button class="btn btn-primary w-100 mt-3" type="submit">
        {% trans "Book Electrician →" %}
      </button>

      <div class="secure-note">
        {% trans "Secure encrypted checkout" %}
      </div>

      <div class="guarantee-card">
        <div class="guarantee-icon">100</div>
        <div>
          <strong>{% trans "Guaranteed Safety" %}</strong>
          <div>{% trans "Background checked & certified" %}</div>
        </div>
      </div>

    </div>
  </div>
</form>
{% endblock %}
